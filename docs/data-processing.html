<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 2 Data processing | Open Trade Statistics</title>
  <meta name="description" content="Section 2 Data processing | Open Trade Statistics" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 2 Data processing | Open Trade Statistics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://docs.tradestatistics.io" />
  
  
  <meta name="github-repo" content="tradestatistics/documentation-v2" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 2 Data processing | Open Trade Statistics" />
  
  
  

<meta name="author" content="Pachá (Mauricio Vargas Sepúlveda)" />


<meta name="date" content="2022-01-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="accesing-the-data.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>



<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Table of Contents</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#project-goals"><i class="fa fa-check"></i><b>1.1</b> Project goals</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-sources-and-availability"><i class="fa fa-check"></i><b>1.2</b> Data sources and availability</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>1.3</b> Code of Conduct</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#open-source-sponsorships"><i class="fa fa-check"></i><b>1.4</b> Open Source Sponsorships</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-processing.html"><a href="data-processing.html"><i class="fa fa-check"></i><b>2</b> Data processing</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-processing.html"><a href="data-processing.html#tidy-data"><i class="fa fa-check"></i><b>2.1</b> Tidy Data</a></li>
<li class="chapter" data-level="2.2" data-path="data-processing.html"><a href="data-processing.html#data-cleaning"><i class="fa fa-check"></i><b>2.2</b> Data cleaning</a></li>
<li class="chapter" data-level="2.3" data-path="data-processing.html"><a href="data-processing.html#github-repositories"><i class="fa fa-check"></i><b>2.3</b> GitHub repositories</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="accesing-the-data.html"><a href="accesing-the-data.html"><i class="fa fa-check"></i><b>3</b> Accesing the data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="accesing-the-data.html"><a href="accesing-the-data.html#before-downloading-datasets"><i class="fa fa-check"></i><b>3.1</b> Before downloading datasets</a></li>
<li class="chapter" data-level="3.2" data-path="accesing-the-data.html"><a href="accesing-the-data.html#api"><i class="fa fa-check"></i><b>3.2</b> API</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="accesing-the-data.html"><a href="accesing-the-data.html#available-tables"><i class="fa fa-check"></i><b>3.2.1</b> Available tables</a></li>
<li class="chapter" data-level="3.2.2" data-path="accesing-the-data.html"><a href="accesing-the-data.html#metadata"><i class="fa fa-check"></i><b>3.2.2</b> Metadata</a></li>
<li class="chapter" data-level="3.2.3" data-path="accesing-the-data.html"><a href="accesing-the-data.html#api-parameters"><i class="fa fa-check"></i><b>3.2.3</b> API parameters</a></li>
<li class="chapter" data-level="3.2.4" data-path="accesing-the-data.html"><a href="accesing-the-data.html#available-reporters"><i class="fa fa-check"></i><b>3.2.4</b> Available reporters</a></li>
<li class="chapter" data-level="3.2.5" data-path="accesing-the-data.html"><a href="accesing-the-data.html#yrpc-year-reporter-partner-and-commodity-code"><i class="fa fa-check"></i><b>3.2.5</b> YRPC (Year, Reporter, Partner and Commodity Code)</a></li>
<li class="chapter" data-level="3.2.6" data-path="accesing-the-data.html"><a href="accesing-the-data.html#yrc-year-reporter-and-commodity-code"><i class="fa fa-check"></i><b>3.2.6</b> YRC (Year, Reporter and Commodity Code)</a></li>
<li class="chapter" data-level="3.2.7" data-path="accesing-the-data.html"><a href="accesing-the-data.html#yrp-year-reporter-and-partner"><i class="fa fa-check"></i><b>3.2.7</b> YRP (Year, Reporter and Partner)</a></li>
<li class="chapter" data-level="3.2.8" data-path="accesing-the-data.html"><a href="accesing-the-data.html#yc-year-and-commodity-code"><i class="fa fa-check"></i><b>3.2.8</b> YC (Year and Commodity Code)</a></li>
<li class="chapter" data-level="3.2.9" data-path="accesing-the-data.html"><a href="accesing-the-data.html#yr-year-and-reporter"><i class="fa fa-check"></i><b>3.2.9</b> YR (Year and Reporter)</a></li>
<li class="chapter" data-level="3.2.10" data-path="accesing-the-data.html"><a href="accesing-the-data.html#imputed-tables"><i class="fa fa-check"></i><b>3.2.10</b> Imputed tables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="accesing-the-data.html"><a href="accesing-the-data.html#r-package"><i class="fa fa-check"></i><b>3.3</b> R Package</a></li>
<li class="chapter" data-level="3.4" data-path="accesing-the-data.html"><a href="accesing-the-data.html#dashboard-beta"><i class="fa fa-check"></i><b>3.4</b> Dashboard (beta)</a></li>
<li class="chapter" data-level="3.5" data-path="accesing-the-data.html"><a href="accesing-the-data.html#apache-arrow-datasets"><i class="fa fa-check"></i><b>3.5</b> Apache Arrow datasets</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>4</b> References</a></li>
<li class="divider"></li>
<li>
  <a href="https://www.digitalocean.com/">
    <img src="https://opensource.nyc3.cdn.digitaloceanspaces.com/attribution/assets/PoweredByDO/DO_Powered_by_Badge_blue.svg" width="201px">
  </a>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Open Trade Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-processing" class="section level1" number="2">
<h1><span class="header-section-number">Section 2</span> Data processing</h1>
<div id="tidy-data" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Tidy Data</h2>
<p>The project follows Tidy Data principles exposed in <span class="citation"><a href="#ref-tidydata2014" role="doc-biblioref">[1]</a></span> and <span class="citation"><a href="#ref-r4ds2016" role="doc-biblioref">[2]</a></span>. Those principles are closely tied to those of relational databases and Codd’s relational algebra.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="fig/data-science.svg" alt="Data pipeline"  />
<p class="caption">
Figure 2.1: Data pipeline
</p>
</div>
</div>
<div id="data-cleaning" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Data cleaning</h2>
<p>In order to ease data processing (i.e. obtaining trade balance, rankings, etc.) the raw datasets from UN COMTRADE were processed to create single tables where:</p>
<ol style="list-style-type: decimal">
<li>The data considers an aggregation level of six digits in the Harmonized System.</li>
<li>All the observations before 2012 were converted from HS rev 2002 to HS rev 2012.</li>
<li>There is one column for exports and one for imports, respecting that exports are expressed Free on Board (i.e. no transportation costs) and imports are expressed with Cost of Insurance and Freight.</li>
<li>Four tables were created for each year: exports, imports, re-exports and re-imports. Then a full join operation was performed between imports and exports, where missing or non-existing flows are replaced by zero values.</li>
<li>The data is offered the same as UN COMTRADE but tidy. There are reporters and partners that appear as “0-unspecified” instead of “NA”/“NULL”/" "/etc.</li>
</ol>
<p>I also provide alternative tables where I removed transportation costs and mismatches by imputing around 10% of the observations with a gravity-type model and also removed flows with no attributed origin/destination. These tables discount re-imports and re-exports besides harmonizing mismatching flows. The idea of imputing some rows is because I applied a criteria of replacing the observed values with data from the model if and only if that reduced the mismatching between trading partners.</p>
</div>
<div id="github-repositories" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> GitHub repositories</h2>
<ul>
<li><a href="https://github.com/tradestatistics/uncomtrade-datasets-arrow">Getting and cleaning data from UN Comtrade (OTS Yearly Data)</a></li>
<li><a href="https://github.com/tradestatistics/hs12-historic-series">Creating historic HS12 series (OTS Visualization Data)</a></li>
<li><a href="https://github.com/pachadotdev/baci-like-hs12">Creating gravity imputed historic HS12 series (also OTS Visualization Data)</a></li>
<li><a href="https://github.com/tradestatistics/inflation-data">Inflation data (included in the R package)</a></li>
<li><a href="https://github.com/pachadotdev/rtas-and-tariffs">RTAs and Tariffs data (included in the API)</a></li>
<li><a href="https://github.com/tradestatistics/visualization-with-shiny">Shiny dashboard</a></li>
<li><a href="https://github.com/tradestatistics/plumber-api">Plumber API</a></li>
<li><a href="https://github.com/tradestatistics/comtrade-codes">Product and country codes from UN Comtrade (OTS Comtrade Codes)</a></li>
</ul>

</div>
</div>
<h3> References</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-tidydata2014" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">H. Wickham, <span>“Tidy data,”</span> <em>Journal of Statistical Software, Articles</em>, vol. 59, no. 10, pp. 1–23, 2014.</div>
</div>
<div id="ref-r4ds2016" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">H. Wickham and G. Grolemund, <em>R for data science: Import, tidy, transform, visualize, and model data</em>. O’Reilly Media, Inc., 2016.</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="accesing-the-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
